---
title: "레거시에 대한 경험, 지금와 생각해보면 테스트케이스가 없거나 극단적으로 적은게 본질이었다."
description: "테스트가 부족한 레거시에서 큰 머지를 피하고, 작은 변경과 빠른 피드백으로 배포 위험을 낮춘 방식 정리."
pubDate: "2023-02-28T01:54:12+00:00"
source: twitter
tags:
  - 레거시
  - 테스트코드
  - 배포리스크
  - PR운영
  - 회귀오류
---

레거시를 다루며 가장 크게 놓친 건 코드 스타일이나 기술 선택이 아니라 테스트케이스의 부재였다. 개선 하나를 넣으면 오류가 세 개씩 따라오던 시기가 있었고, 팀은 점점 방어적으로 코딩하게 됐다. 당시에는 “새로 만들기 전엔 답이 없다”는 생각이 강했지만, 지금 돌아보면 판단 미스였다. 기능 추가보다 먼저, 깨지는 지점을 확인할 최소 테스트를 우선순위에 올렸어야 했다.

이 문제가 더 선명해진 건 40일 정도 준비한 피처 브랜치를 머지하던 날이었다. QA를 거쳤는데도 불안이 남았다. 커밋 하나의 오류 가능성을 1%로만 잡아도 100개가 모이면 오류가 있을 가능성이 63.4%라는 계산을 떠올리게 된다. 수치 자체보다 중요한 건, 큰 덩어리 머지가 검증 신호를 늦추고 리스크를 한 번에 터뜨릴 수 있다는 점이었다.

그래서 먼저 바꾼 건 코드가 아니라 작업 단위였다. 작업 공유를 자주 하도록 유도하고, 보통 커밋 단위로 중간 상태를 계속 드러냈다. 방향이 어긋난 부분은 왜 잘못됐는지 기준을 붙여 명확히 지적하고, 필요하면 몇 번이든 되돌렸다. 초반엔 리버트가 비효율처럼 보여도, 이 과정이 쌓이면 이후 변경에서 같은 실수를 줄이는 효과가 있었다. 다만 이 방식은 피드백 근거를 분명히 설명할 수 있는 사람이 있어야 안정적으로 굴러간다.

최근에는 PR도 더 작게 끊어 운영한다. 한 번에 많은 변경을 들고 가지 않고, 각 PR에서 변경 내용과 진척을 정리한 뒤 다음 단위로 넘어간다. AI 도구를 함께 쓸 때도 같은 방식이 유효했다. 맥락을 짧게 정리해 다시 시작하면 작업자도 도구도 단기 기억 부담이 줄고, 변경 안정성이 올라간다. 테스트 커버리지를 단기간에 복원하기 어렵다면, 변경을 잘게 나누고 피드백 루프를 촘촘히 만드는 것이 당장 실행 가능한 안전장치다.
