---
title: "@nameEO gpt4에 비해 환각이 많은 느낌이었습니다."
description: "환각과 응답 드리프트를 줄이기 위해 세션 요약, 새 세션 전환, 병렬 서브에이전트 운영으로 코딩 작업을 정리한 기록."
pubDate: 2023-04-14T04:42:10+00:00
source: twitter
tags:
  - ai-coding
  - workflow
  - hallucination
  - context-management
  - sub-agent
---

코딩에 모델을 붙여 쓸 때 가장 먼저 부딪힌 문제는 정확도보다 일관성이었다. 답변이 현재 워크스페이스 소스를 읽고 말하는 듯하다가도, 잠시 뒤에는 존재하지 않는 파일이나 코드를 전제로 설명이 이어졌다. 같은 프롬프트에서도 리제너레이션마다 방향이 달라져서, 정답을 찾는 일보다 지금 답변을 믿어도 되는지 확인하는 비용이 더 커졌다. GPT-4와 비교해 환각 체감이 더 컸다는 메모도 이 지점에서 나왔다.

그래서 접근을 바꿨다. 모델을 더 똑똑하게 만드는 대신 세션을 짧게 운영하는 규칙을 뒀다. 대화가 길어져 답변이 흐려지면 결정사항, 제약, 남은 작업을 `context.md`로 요약해 저장하고 새 세션으로 넘어갔다. 세션 길이 제한 옵션이 있으면 확인했고, 없어도 수동 리셋 주기를 만들었다. 정확한 원인을 단정하기는 어렵지만, 컨텍스트가 커질수록 성능이 떨어진다는 관찰에는 이 방식이 가장 즉각적이었다.

토큰 여유가 있는 경우에는 단일 대화에 몰지 않고 서브에이전트를 병렬로 돌렸다. 연도별 조사처럼 독립 가능한 일을 다섯 갈래로 나누고 마지막에 취합하는 식이다. 핵심은 품질을 자동으로 높이는 게 아니라 병목을 줄이고 중간 산출물을 비교 가능하게 만드는 데 있었다. 다만 비용과 검수 부담이 함께 늘기 때문에, 병렬화 전에 입력 범위와 출력 형식을 고정하지 않으면 정리 시간이 더 길어졌다.

결국 코딩 워크플로우에서 중요한 건 좋은 답 하나보다 나쁜 답을 빨리 격리하는 구조였다. 세션 요약, 새 세션 전환, 병렬 분업은 화려한 기법이 아니라 실패를 작게 만드는 운영 장치에 가깝다. 특정 모델이 인프라 문맥에서 장점이 있어도 코딩 맥락에서는 아쉬울 수 있다는 경험도 같은 맥락이다. 모델 특성을 탓하기 전에 작업 경계와 리셋 규칙을 먼저 설계해두면, 환각과 응답 드리프트는 완전히 사라지지 않아도 통제 가능한 문제로 바뀐다.
