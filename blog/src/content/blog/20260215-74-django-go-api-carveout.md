---
title: 성장 구간에서 Django API를 분리하며 정리한 기준
description: 프레임워크 교체보다 경계 분리와 쓰기 경로 재설계를 먼저 택한 이유를 실무 관점에서 기록했다.
pubDate: 2024-08-28T12:00:20+00:00
source: twitter
tags:
  - django
  - go
  - architecture
  - msa
  - sqs
---

프로젝트가 커지면서 보인 문제는 Django 자체의 결함이라기보다 구조의 부담에 가까웠다. 도메인은 어느 정도 안정됐고 고가용성 요구는 커졌는데, 한 코드베이스에서 여러 도메인을 가로질러 개발하다 보니 팀 피로가 먼저 올라왔다. 그래서 프레임워크를 비판하기보다, 서비스 규모에 맞게 경계를 다시 그리는 쪽이 맞다고 봤다. 어떤 기술을 쓰느냐보다 지금 단계에서 어떤 분리가 필요한지가 우선이었다.

실행은 작게 시작했다. Django에 붙어 있던 API를 하나씩 떼어 Go 서비스로 옮겼다. 이번에는 저장소 크기가 작아서 전체 코드를 맥락으로 넣고 옮기는 방식을 택했고, 내가 직접 타이핑한 코드는 5%도 안 됐다. 핵심은 새 구조를 과시하는 게 아니라 기존 로직을 깨지 않고 분리하는 일이었다. 기능을 추가하거나 설계를 크게 바꾸는 건 경계가 안정된 뒤로 미뤘다.

다음 단계로 잡은 건 쓰기 경로다. 요청을 바로 DB에 쓰지 않고 SQS에 대기시킨 뒤 모아서 bulk insert로 처리하려고 했다. 기대 성능은 '한 10배' 수준으로 봤지만, 이 수치는 아직 운영에서 검증된 결과가 아니라 구현 전 추정치다. 그래도 요청을 평탄화하고 쓰기 횟수를 줄이는 방향은 분명해서, 병목이 쓰기 구간에 있을 때는 실용적인 선택이라고 판단했다. 정확한 효과는 배포 후 지표로 확인해야 한다.

Go로 옮기다 보면 '이것까지 직접 구현해야 하나' 싶은 순간이 자주 나온다. 그럼에도 분리 그 자체에서 얻는 운영상의 명료함이 컸다. 그리고 그 효과는 Go라서가 아니라 경계를 떼어냈기 때문에 생긴다고 느꼈다. 같은 분리를 Django로 했어도 본질은 크게 다르지 않았을 것이다. 결국 중요한 건 언어 선호가 아니라, 서비스 규모와 도메인 성숙도, 가용성 요구에 맞춰 구성을 계속 조정하는 판단력이다.
