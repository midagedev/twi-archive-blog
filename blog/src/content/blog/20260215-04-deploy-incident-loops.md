---
title: "깃헙액션이랑 엮인 배포가 깃헙의 서비스 상태에 영향을 받다보니 깃헙스테이터스 알림을 슬랙채널로 받게 팀원분이 작업을 해두셨다."
description: "GitHub 상태 알림을 슬랙으로 받기 시작한 뒤, 외부 장애와 내부 재시도 버그가 배포 사고를 키우는 방식과 대응 기준을 정리한 기록."
pubDate: 2024-08-27T23:19:19+00:00
source: twitter
tags:
  - devops
  - deployment
  - incident
  - github-actions
  - sqs
---

배포가 GitHub Actions에 묶여 있으면 애플리케이션 코드가 멀쩡해도 외부 서비스 상태 하나로 릴리스가 멈춘다. 팀원이 GitHub Status 알림을 슬랙 채널로 연결해 둔 뒤 이 사실이 숫자보다 체감으로 먼저 보였다. 생각보다 자주 경고가 뜨고, 잠시 뒤 resolved가 올라와도 그 사이 배포 판단은 이미 흔들린다. 예전에는 실패를 파이프라인 설정 문제로만 봤는데, 이제는 공급자 장애가 배포 실패 원인의 한 축이라는 전제를 기본으로 둔다.

실행 방식도 바꿨다. Actions 로그만 보고 재시도하는 대신, 상태 알림 시각과 배포 승인 시점을 같이 기록해 원인을 분리했다. 외부 상태가 불안정할 때는 ‘일단 진행’이 아니라 ‘일단 보류’를 기본값으로 두고, 긴급 배포만 예외로 열었다. 운영 채널에서는 누가 맞는지 토론하기보다 지금 창구가 안전한지부터 확인했다. 이 단계가 들어가니 같은 실패를 개인 실수로 몰아가는 일도 줄었다.

하지만 외부 의존성만 관리해서는 사고가 끝나지 않았다. 내부에서는 실패 큐를 지우지 않고 서킷브레이커를 피해 다시 SQS로 넣는 버그가 있었고, 테스트 메시지 1건이 5분 만에 300만 건으로 증식했다. 그 트래픽이 CPU 오토스케일링을 건드리면서 노드까지 늘어났다. 장애를 키운 건 단일 버그 자체보다, 재시도 경로에 상한과 차단 조건이 없었던 구조였다. 외부가 흔들리는 날에는 이런 구조적 허점이 더 빨리 폭발한다.

비슷한 맥락에서 서버리스 DB가 한 달에 한 번꼴로 재기동되는 문제도 겪었다. 클러스터를 점진적으로 바꾸려다 중간 상태를 오래 방치한 대가였다. 여기에 배포를 독촉하는 분위기가 겹치면, 결국 실사용자 이슈를 급하게 막는 대응으로 돌아간다. 당시 사건별 비용이나 사용자 영향도를 정량으로 남기지는 못해서, 사후 비교가 어려웠던 점은 분명한 한계였다.

지금은 배포를 출시 이벤트가 아니라 리스크 라우팅 작업으로 본다. 외부 상태 알림은 필수 입력으로 받고, 내부 큐·재시도·오토스케일 경로는 ‘폭증 시나리오’ 기준으로 먼저 점검한다. 그리고 일정 압박이 올라오면 속도 논쟁보다 중단 조건을 먼저 합의한다. 크게 복잡한 해법보다, 멈춰야 할 때 멈추는 규칙과 기록 방식이 반복 사고를 가장 확실하게 줄여줬다.
