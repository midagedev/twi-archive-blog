---
title: "피드백 감사합니다."
description: "규칙성이 약한 장애를 다룰 때 범위를 좁히고 분석 단위를 재설계한 기록."
pubDate: 2022-04-19T10:10:44+00:00
source: twitter
tags:
  - debugging
  - 장애대응
  - serverless
  - engineering
---

가끔만 터지는 장애가 제일 어렵다. 대략 4개월 전부터 한 달에 한두 번 나타나던 문제가 있었고, 최근에는 빈도만 조금 올라갔다. 문제를 좁히기 좋은 규칙성도 없었다. 스케줄링 작업처럼 특정 시점에 묶이지 않으니 재현 경로를 만들기 어려웠고, 대응할 때마다 로그를 다시 뒤져야 했다. 공개된 정보만으로는 장애 증상 자체를 단정하기도 힘들어서, 처음부터 정답을 확정하기보다 관찰 틀을 다시 세우는 일이 먼저였다.

초기에는 CPU 사용률이 20%를 넘지 않았기 때문에 서버리스 자원 부족은 아닐 거라고 봤다. 그런데 피드백을 받고 나니 판단 기준이 너무 한 축에만 붙어 있었다는 걸 인정하게 됐다. CPU가 낮아도 동시 처리량, 외부 의존성 지연, 런타임 제한 같은 다른 부하 축에서 병목은 생길 수 있다. 그래서 지표를 더 잘게 나눴다. 호출 구간별 지연, 실패 시점의 공통 요청 패턴, 재시도 누적 여부처럼 CPU 밖 신호를 우선 확인하는 방식으로 질문을 바꿨다.

요구사항 문장만 보면 단순해 보이는 이슈도 실제로는 기존 구조를 거의 다 훑어야 시작점이 보일 때가 있다. 그래서 초반에 미뤄졌고, 어디서부터 조사해야 할지 바로 각이 안 났다는 말이 정확했다. 이럴수록 이슈 목록을 넓게 모아 답을 듣는 방식은 효율이 떨어진다. 소수 이슈를 깊게 파서 가설을 줄이고, 근거가 약한 추정은 빨리 버리는 쪽이 낫다. 결국 해결은 정답 문장을 외우는 일이 아니라, 시스템 문맥 안에서 원인을 재구성할 수 있는 사람과 과정에서 나온다.

결과를 한 줄로 말하면, 빠른 결론보다 조사 설계를 먼저 고치는 쪽이 효과적이었다. 발생 주기, 공통 전후 조건, 관측 지점을 최소 단위로 다시 묶고 가설을 작게 나눠 확인해야 했다. 아직 공개된 정보만으로 최종 원인을 확정할 수는 없지만, 이 접근은 다음 대응 비용을 낮춰 준다. 현장 대응도 마찬가지다. 급한 조치는 급하게 하되, 분석과 기록은 방해가 적은 자리에서 이어가야 한다. 약한 신호 장애는 많이 아는가보다 어디를 깊게 팔지 정하는가에서 차이가 난다.
