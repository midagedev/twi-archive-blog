---
title: 시스템 사이에서 터지는 장애를 줄이기 위한 운영 가드레일
description: CI 외부 의존성, 분석 지표 불일치, 재시도 폭주를 겪으며 정리한 알림·검증·폭발 반경 제어 기준.
pubDate: 2023-09-18T07:56:21+00:00
source: twitter
tags:
  - 운영
  - 장애대응
  - 데이터검증
  - SRE
  - 트위터아카이브
---

운영에서 자주 부딪힌 문제는 코드 내부보다 시스템 사이 경계에서 생겼다. 배포가 GitHub Actions에 묶여 있으니 우리 쪽 변경이 없어도 GitHub 상태가 흔들리면 파이프라인이 같이 흔들렸다. 팀에서 GitHub Status 알림을 슬랙 채널로 받기 시작한 뒤에야, 외부 상태 이슈가 생각보다 잦다는 걸 체감했다. resolved 알림으로 복구 시점까지 함께 보면서, 배포 실패를 볼 때 먼저 내부 결함인지 외부 의존성인지를 분리해서 판단하는 습관이 생겼다. 외부 서비스의 상세 원인은 우리가 알 수 없는 경우가 많다는 전제도 같이 받아들였다.

데이터 쪽도 같은 패턴이었다. Google Ads 리포트, BigQuery 익스포트 데이터, Google Analytics 조회값이 서로 달라서 의사결정이 멈추는 순간이 있었다. 여기에 특정 국가의 날씨 변화가 매출 변동에 영향을 주는 상황까지 겹치면, 숫자 하나를 절대값처럼 다루기 더 어려워진다. 그래서 단일 대시보드에 정답을 기대하기보다, 집계 기준과 시간대, 반영 지연 구간을 먼저 고정하고 소스 간 비교 규칙을 문서로 맞추는 쪽이 실무적으로 낫다는 결론을 택했다.

가장 큰 사고는 재시도 경로에서 났다. 실패한 큐 메시지를 삭제하지 않고 서킷브레이커를 피해 다시 SQS로 넣는 버그 때문에, 테스트 메시지 1건이 5분 만에 300만 건으로 증식했다. CPU 부하에 오토스케일링이 반응하면서 노드도 같이 늘어났다. 이 경험 이후로는 “재시도는 안전하다”는 가정을 버렸다. 재시도 자체보다 먼저 봐야 할 건 증식 조건, 우회 경로, 자동 확장과 결합될 때의 폭발 반경이었다.

지금은 가드레일을 기본 구성으로 둔다. 외부 플랫폼 상태 알림을 운영 채널에 연결해 배포 판단에 즉시 반영하고, 지표는 소스 간 대사 검증으로 차이를 조기에 잡는다. 큐 처리에는 최대 재시도 횟수, DLQ 격리, 처리율 제한, 긴급 차단 스위치를 함께 둬서 번지는 속도를 늦춘다. 이런 장치가 장애를 없애주지는 않는다. 다만 장애가 시작됐을 때 어디서 멈추고 무엇을 먼저 잘라낼지, 팀이 같은 기준으로 더 빨리 결정하게 해준다.
