---
title: "지표 수집하는데에만 램을 1gb나 쓰는건 오바다."
description: "도구 이름보다 실제 운영 동작을 기준으로 지표 수집과 어낼리틱스 스택을 비교한 기록."
pubDate: 2022-09-28T13:23:06+00:00
source: twitter
tags:
  - observability
  - analytics
  - tooling
  - operations
---

운영에서 도구를 고를 때 기능표보다 런타임 비용을 먼저 본다. 지표 수집 에이전트가 관측 대상보다 메모리를 더 먹으면 구조가 뒤집힌다. 지표 수집만으로 램 1GB를 쓰는 상태는 과했다. 그래서 grafana alloy를 오래 튜닝하기보다 vmagent로 교체했다. 기준은 새로움이 아니라 기본 비용이었다.

교체 뒤에는 숫자와 연결부터 확인했다. vmagent는 메모리를 100MB도 쓰지 않았고, grafana cloud에 붙은 prom으로 지표 전송도 동작했다. 대시보드 조회까지 확인하고 전환을 마무리했다. alloy를 더 최적화하면 줄일 여지는 있었을 수 있다. 그래도 당시에는 잠재력보다 즉시 안정적으로 돌아가는 구성이 필요했다.

어낼리틱스도 같은 방식으로 봤다. GA4, amplitude, mixpanel을 동시에 붙이고, 벤더 화면만 믿지 않으려고 이벤트 raw 데이터를 따로 저장했다. 같은 이벤트라도 집계 기준이 다르면 해석이 흔들린다. GA4는 유입 경로 분석 관점에서 남길지 보고, 나머지는 유료 플랜 전에 데이터 품질과 활용성을 비교했다.

결국 평가는 용도 적합성 문제라는 점을 자주 확인했다. Elasticsearch는 로그 탐색 용도로 쓰면 평이 좋고, 도큐먼트 DB처럼 쓰면 불만이 커진다는 관찰이 있다. ffmpeg wasm도 비슷하다. 래핑 모듈이 편해도 제어 범위가 크면 코어를 직접 다루는 편이 맞다. 도구의 이름보다 사용 맥락이 결과를 가른다.

정리하면 기준은 단순하다. 먼저 자원 사용량과 데이터 흐름을 측정하고, 교체 뒤에는 전송과 조회까지 끝단 동작을 검증한다. 그다음 기능 수보다 현재 문제에 맞는지를 본다. 아직 모든 도구 비교의 최종 결론은 없다. 다만 이 방식은 과한 비용을 빨리 줄이고 판단을 덜 감으로 하게 만든다.
