---
title: "크롤링은 엣지 케이스를 내가 처리하느냐 내가 돈을 준 업체가 처리하느냐 정도의 차이일뿐 누군가 그걸 해야하더라."
description: "크롤링, 검색 인프라, 로그 보존에서 공통으로 생기는 운영 복잡도를 기준으로 도구 선택 기준을 정리했다."
pubDate: 2023-06-01T19:53:46+00:00
source: twitter
tags:
  - crawling
  - 운영복잡도
  - 검색인프라
  - aws
  - engineering
---

실무에서 복잡도는 코드 안에서만 생기지 않는다. 코드 리뷰로 if문을 줄여도 크롤링을 넣는 순간 외부 시스템의 예외가 우리 프로세스에 들어온다. 스테이징은 정상인데 프로덕션 일부 고객만 실패했던 적도 있었다. 서브도메인 쿠키가 도메인 레벨로 붙어 요청 헤더가 Nginx 기본 한도를 넘은 케이스였다.

그래서 크롤링 이야기가 나오면 먼저 운영 책임부터 본다. 직접 크롤링을 하다 외부 서비스로 바꿨을 때도 본질은 같았다. 문제를 없앤 게 아니라 처리 주체를 바꾼 것이다. 업체가 강조한 것도 기능이 아니라 24시간 엣지 케이스 대응 인력과 관제였다. 결국 질문은 가능한가보다 누가 즉시 처리할 수 있는가다.

검색 인프라도 같은 기준으로 봤다. 비정형 데이터나 풀텍스트 검색은 ES가 맞지만, 완전 정형 데이터까지 넣으면 갱신 지연 대응이 계속 생긴다. 11시에 오픈되는 상품 노출, 11시부터 바뀐 할인 가격의 정렬 반영은 RDB에서는 비교적 단순하다. ES를 사이에 두면 이벤트 소싱, 집계, 재처리까지 함께 운영해야 했다. 할 수는 있지만 우선순위가 아니면 낭비가 된다.

로그 보존은 더 단순한 문제다. CloudTrail 기본 보존 90일을 그대로 두면 사고 시점에 필요한 변경 이력이 사라진다. 누가 시크릿 키를 바꿨는지, 버킷 공개 설정을 바꿨는지 확인조차 못 한다. 그래서 도구 찬반보다 먼저 세 가지를 확인한다. 새 복잡도의 책임 주체가 명확한가, 지연을 감당할 수 있는가, 감사 로그를 장기 보존하는가. 이 기준이 없으면 기술 선택은 나중에 운영비로 돌아온다.
