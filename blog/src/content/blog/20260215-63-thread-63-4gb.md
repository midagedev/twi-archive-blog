---
title: "메트릭관리 고민해보다가 4gb램으로는 도저히 그라파나+프로메테우스 셀프호스팅은 무리라고 판단하고 찾다보니 그라파나클라우드 프리티어"
description: 4GB RAM 제약에서 셀프호스팅 관측 스택을 접고 Grafana Cloud 프리티어와 vmagent로 구성한 판단과 적용 기록.
pubDate: 2025-10-07T04:41:03+00:00
source: twitter
tags:
  - observability
  - grafana-cloud
  - prometheus
  - vmagent
  - infra
---

메트릭 관리를 붙이려고 보니 첫 제약은 기능이 아니라 메모리였다. 4GB RAM 환경에서 그라파나와 프로메테우스를 같이 셀프호스팅하는 구성은 여유가 거의 없다고 판단했다. 실제로 클러스터에서 CPU를 가장 많이 쓰는 쪽이 지표 기록 프로세스였고, 관측 때문에 본 서비스 여력을 깎는 구조가 됐다.

그래서 저장과 조회는 직접 들고 가지 않고 그라파나 클라우드 프리티어로 옮겨 써봤다. 14일 보존이라는 제한은 있지만, 당시 우선순위는 장기 보관보다 문제 징후를 바로 확인하는 루프를 만드는 일이었다. 제한된 자원 안에서 대시보드를 안정적으로 확인할 수 있는 경로를 먼저 확보하는 쪽이 현실적이었다.

수집기도 다시 손봤다. 지표 수집에만 RAM 1GB를 쓰는 건 과하다고 보고 grafana alloy는 포기하고 vmagent로 교체했다. 교체 뒤에는 메모리가 100MB도 안 들었고, vmagent에서 그라파나 클라우드에 연결된 Prometheus로 지표가 정상 전송되고 대시보드에서도 잘 보였다. alloy를 더 최적화하면 달라질 수 있겠지만, 이번에는 최적화 실험보다 가벼운 구성을 우선했다.

정리하면 작은 인프라에서는 관측 스택도 “가능한가”보다 “지속 가능한가”를 먼저 봐야 한다. 보존 기간 14일 같은 한계를 명확히 받아들이고, 수집-전송-조회 경로를 단순하게 만든 다음 필요할 때 확장하는 편이 낫다. 트래픽이 더 커졌을 때의 한계는 아직 추가 데이터가 필요하다.
