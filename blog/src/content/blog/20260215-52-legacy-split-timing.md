---
title: "아 벼르고 벼르던 모듈 분리 오늘 첫삽 떴다."
description: 리팩토링을 미루거나 서두르는 대신, 분리 시점과 삭제 기준, 추상화 기준을 실제 작업 흐름으로 정리한 기록.
pubDate: 2023-10-17T15:42:21+00:00
source: twitter
tags:
  - 리팩토링
  - 레거시
  - 모듈분리
  - 기술부채
---

리팩토링 타이밍은 늘 같은 질문으로 돌아온다. 지금 찢을지, 더 버틸지. 내 경우엔 한 서비스에 기능을 계속 얹는 방식이 임계점을 넘었을 때 신호가 분명했다. 특정 기능 하나의 문제가 끝나지 않고, 기능별 장애 가능성이 곱해지면서 전체 장애 확률이 같이 올라가는 구간이었다. 프레임워크 탓으로 보이는 문제도 실제로는 경계 없이 붙어 있는 구조에서 시작되는 경우가 많았다.

그래서 벼르던 모듈 분리를 시작했다. 다만 레거시 리팩토링에 리소스를 쓰는 걸 두고 바로 반발이 나올 수 있다는 현실 제약이 있었다. 나는 큰 설계 문서보다 작은 PR을 먼저 만들고, 바로 한 명을 붙잡아 대면 리뷰를 받았다. 리뷰에서 위험 구간을 확인한 뒤 빠르게 배포해 실제 경계를 만들기 시작했다. 핵심은 “완벽한 재설계”가 아니라 장애 범위를 줄이는 첫 삽을 뜨는 일이었다.

같이 정리한 기준이 두 가지 있다. 첫째, 안 쓰는 코드는 미루지 말고 지운다. 사용되지 않는 코드는 다음에 다시 읽을 때마다 “정말 안 쓰나?”를 재검증하게 만들고, 그 비용이 누적되다가 실수로 이어진다. 둘째, 중복 3곳을 봤다고 바로 추상화하지 않는다. 중복 자체보다 더 큰 문제는 서로 다른 맥락을 억지로 한 레이어에 묶어 복잡도를 키우는 일이다. 나는 먼저 불편한 지점을 글로 써서, 진짜로 공통화할 대상인지 확인한 뒤 움직인다.

결과는 화려하지 않다. 아직 분리 초입이라 성능이나 장애 지표를 숫자로 말할 단계는 아니다. 대신 판단이 빨라졌고, “지금 뭘 줄여야 하는지” 기준이 생겼다. 적용 포인트도 단순하다. 전체 장애가 함께 흔들리기 시작하면 분리를 검토하고, 배포 위험이 크면 PR 단위를 더 잘게 쪼개 즉시 리뷰한다. 그리고 당장 필요한 문제가 아닌데 시스템을 무겁게 만드는 선택, 예를 들어 운영 시점 정렬·노출 같은 요구를 해결하려고 복잡한 흐름을 먼저 도입하는 일은 끝까지 경계한다.
